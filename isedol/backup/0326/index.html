<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SPA 사이트 - 전체 섹션 포함</title>
  <!-- Swiper CSS CDN -->
  <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
  <style>
    /* 기본 스타일 */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; line-height: 1.6; background-color: black; color: white; }
    .container { max-width: 1200px; margin: 0 auto; padding: 10px; }
    header { display: flex; justify-content: space-between; align-items: center; padding: 20px 0; }
    header .left, header .center, header .right { flex: 1; }
    header .left { text-align: left; }
    header .center { text-align: center; }
    header .right { text-align: right; }
    .nav a { margin: 0 15px; text-decoration: none; color: white; cursor: pointer; font-weight: bold; }
    .profile { display: inline-flex; align-items: center; }
    .profile-card { width: 40px; height: 40px; background-color: gray; border-radius: 50%; margin-right: 10px; flex-shrink: 0; }
    .guest-name { margin-right: 10px; }
    .right .profile > button { background-color: #9b59b6; width: max(4vw, 80px); height: max(2vh, 44px); color: white; border: none; border-radius: 2rem; font-weight: bold; margin-left: 0.2rem; cursor: pointer; }
    .main-content section { margin: 20px 0; padding: 40px; text-align: center; }

    /* 배너 섹션 */
    #banner .main_banner { position: relative; }
    #banner .swiper-container { width: 100%; height: max(20vw, 300px); overflow: hidden; }
    #banner .swiper-slide { display: flex; align-items: center; justify-content: center; font-size: 1.5em; font-weight: bold; color: white; }
    #banner .swiper-slide:nth-child(1) { background-color: #3498db; }
    #banner .swiper-slide:nth-child(2) { background-color: #2ecc71; }
    #banner .swiper-slide:nth-child(3) { background-color: #e74c3c; }
    #banner .swiper-slide:nth-child(4) { background-color: #f1c40f; }
    #banner .swiper-slide:nth-child(5) { background-color: #9b59b6; }
    .swiper-button-next, .swiper-button-prev { color: white; }
    .swiper-pagination-bullet { background: white; }

    /* MEMBER 섹션 */
    #member { height: 20vh; background: none; padding: 0; }
    #main-member { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; position: relative; overflow: hidden; }
    .member-icons { display: flex; justify-content: space-around; align-items: center; width: 100%; transition: all 2.5s ease; }
    .member-icon { width: 80px; height: 80px; border-radius: 50%; background-color: #9b59b6; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; cursor: pointer; transition: transform 1.5s ease, opacity 1.5s ease; }
    .member-icon:hover { transform: scale(1.1); box-shadow: 0 0 10px white; }
    .member-icons.fold .member-icon[data-index="1"] { transform: translateX(150px); opacity: 0; }
    .member-icons.fold .member-icon[data-index="2"] { transform: translateX(80px); opacity: 0; }
    .member-icons.fold .member-icon[data-index="3"] { transform: translateX(30px); opacity: 0; }
    .member-icons.fold .member-icon[data-index="4"] { transform: translateX(-30px); opacity: 0; }
    .member-icons.fold .member-icon[data-index="5"] { transform: translateX(-80px); opacity: 0; }
    .member-icons.fold .member-icon[data-index="6"] { transform: translateX(-150px); opacity: 0; }
    .member-detail { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: white; color: black; border-radius: 10px; padding: 20px; opacity: 0; transform: scale(0); transition: transform 1s ease, opacity 1s ease; }
    .member-detail.active { display: block; opacity: 1; transform: scale(1); }
    .member-detail-content { display: flex; gap: 20px; height: 100%; }
    .detail-left, .detail-right { flex: 1; }
    .detail-left { display: flex; flex-direction: row; justify-content: space-between; gap: 10px; height: 100%; }
    .detail-photo { background: #bdc3c7; width: 100%; height: 100%; border-radius: 5px; display: flex; align-items: center; justify-content: center; color: black; font-weight: bold; }
    .detail-right { display: flex; align-items: center; justify-content: center; font-size: 1.1em; }
    .detail-close { position: absolute; top: 10px; right: 10px; background: red; border: none; color: white; font-size: 1em; font-weight: bold; padding: 5px 10px; border-radius: 50%; cursor: pointer; z-index: 10; transition: opacity 0.5s ease; }

    /* 최신곡 섹션 */
    .latest-song-wrapper { display: flex; gap: 20px; flex-wrap: wrap; }
    .album-art-container { flex: 1; min-width: 250px; position: relative; height: 300px; perspective: 1000px; overflow: hidden; }
    .album-art-container .card { position: absolute; width: 100%; height: 100%; border-radius: 10px; transition: transform 0.5s ease, opacity 0.5s ease; display: flex; align-items: center; justify-content: center; font-size: 1.2em; font-weight: bold; }
    .album-art-container .card.card1 { background-color: #444; opacity: 1; transform: rotate(0deg); transition: all 0.5s ease; }
    .album-art-container .card.card2 { background-color: #888; opacity: 0; transform: rotate(0deg); transition: all 1s ease; }
    .album-art-container:hover .card.card1 { transform: rotate(-360deg); opacity: 0; transition: all 1s ease; }
    .album-art-container:hover .card.card2 { transform: rotate(360deg); opacity: 1; transition: all 0.5s ease; }
    .song-icons { flex: 1; min-width: 250px; display: flex; justify-content: center; align-items: center; transition: all 2s ease; }
    .song-icons .icon-item { display: inline-flex; align-items: center; margin: 0 10px; transition: all 2s ease; }
    .song-icons .icon-item .icon { width: 40px; height: 40px; background-color: #666; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.9em; color: white; }
    .song-icons .icon-item span { display: none; margin-left: 0; opacity: 0; white-space: nowrap; transition: opacity 0.5s ease, margin-left 0.5s ease; }
    .song-icons.vertical { flex-direction: column; align-items: flex-start; }
    .song-icons.vertical .icon-item { margin: 10px 0; }
    .song-icons.vertical .icon-item span { opacity: 1; margin-left: 10px; }

    /* VIDEO 섹션 */
    #video { padding: 20px 0; position: relative; }
    #video h2 { margin-bottom: 20px; }
    .video-container { position: relative; height: 700px; overflow: hidden; padding-inline: 4vw; }
    .video-card {
      position: absolute;
      width: 150px;
      height: 150px;
      background: #777;
      border-radius: 10px;
      text-align: center;
      line-height: 150px;
      font-weight: bold;
      transition: all 0.5s ease;
      opacity: 0;
    }
    /* 애니메이션 클래스: 스크롤 후 등장 및 플로팅 효과 */
    .video-card.animate {
      opacity: 1;
      transform: translateY(0);
    }
    .float-animation {
      animation: float 3s ease-in-out infinite;
    }
    @keyframes float {
      0% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
      100% { transform: translateY(0); }
    }
    /* 클릭 시 active 스타일 */
    .video-card.active {
      z-index: 10;
      /* 중앙 배치 및 확대 (나중에 JS로 inline style 조정) */
    }
    /* 다른 카드 숨김 */
    .video-card.hidden {
      opacity: 0 !important;
      pointer-events: none;
    }
    /* 닫기 버튼 */
    .close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: red;
      color: white;
      border: none;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      cursor: pointer;
      display: none;
      z-index: 20;
    }
    .close-btn.show { display: block; }

    /* AWARD 섹션 (이전과 동일) */
    #award { padding: 40px 0; }
    #award h2 { margin-bottom: 20px; }
    .reward-row { position: relative; overflow: hidden; margin: 20px 0; }
    .reward-slider {
      display: flex;
      width: calc(200%);
      animation: slideLTR 20s linear infinite;
    }
    .reward-row[data-direction="rtl"] .reward-slider {
      animation: slideRTL 20s linear infinite;
    }
    .reward-card {
      flex: 0 0 calc(100%/6);
      max-width: calc(100%/6);
      height: 100px;
      margin: 0 5px;
      background: #555;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: white;
      border-radius: 10px;
    }
    .fade {
      position: absolute;
      top: 0;
      width: 100px;
      height: 100%;
      pointer-events: none;
      z-index: 2;
    }
    .fade.fade-left { left: 0; background: linear-gradient(to right, #222, transparent); }
    .fade.fade-right { right: 0; background: linear-gradient(to left, #222, transparent); }
    @keyframes slideLTR {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }
    @keyframes slideRTL {
      0% { transform: translateX(-50%); }
      100% { transform: translateX(0); }
    }

    /* 반응형 */
    @media (max-width: 768px) {
      header { flex-direction: column; align-items: flex-start; }
      header .left, header .center, header .right { width: 100%; text-align: left; margin-bottom: 10px; }
      .nav a { margin: 0 8px; }
      .swiper-container { height: 200px; }
      .album-art-container { height: 200px; }
      .member-icons { flex-wrap: wrap; gap: 10px; }
      .member-icon { width: 60px; height: 60px; }
      .reward-card { flex: 0 0 calc(100%/3); max-width: calc(100%/3); height: 150px; margin: 0 3px; }
      .fade { width: 50px; }
      .video-card { width: 100px; height: 100px; line-height: 100px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- 상단 영역 -->
    <header>
      <div class="left">
        <div class="logo">Logo</div>
      </div>
      <div class="center">
        <nav class="nav">
          <a data-page="main" href="#">MAIN</a>
          <a data-page="member" href="#">MEMBER</a>
          <a data-page="news" href="#">NEWS</a>
          <a data-page="playlist" href="#">PLAYLIST</a>
        </nav>
      </div>
      <div class="right">
        <div class="profile">
          <div class="profile-card"></div>
          <span class="guest-name">GUEST</span>
          <button id="auth-btn">Login</button>
        </div>
      </div>
    </header>
    
    <!-- 콘텐츠 영역 -->
    <div class="main-content">
      <!-- 배너 섹션 -->
      <section id="banner">
        <div class="swiper-container main_banner">
          <div class="swiper-wrapper">
            <div class="swiper-slide">슬라이드 1</div>
            <div class="swiper-slide">슬라이드 2</div>
            <div class="swiper-slide">슬라이드 3</div>
            <div class="swiper-slide">슬라이드 4</div>
            <div class="swiper-slide">슬라이드 5</div>
          </div>
          <div class="swiper-button-next"></div>
          <div class="swiper-button-prev"></div>
          <div class="swiper-pagination"></div>
        </div>
      </section>
      
      <!-- MEMBER 섹션 -->
      <section id="member">
        <div id="main-member">
          <div class="member-icons" id="member-icons">
            <div class="member-icon left-icon" data-index="1">1</div>
            <div class="member-icon left-icon" data-index="2">2</div>
            <div class="member-icon left-icon" data-index="3">3</div>
            <div class="member-icon right-icon" data-index="4">4</div>
            <div class="member-icon right-icon" data-index="5">5</div>
            <div class="member-icon right-icon" data-index="6">6</div>
          </div>
          <div class="member-detail" id="member-detail">
            <button class="detail-close" id="detail-close">X</button>
            <div class="member-detail-content">
              <div class="detail-left">
                <div class="detail-photo">Photo 1</div>
                <div class="detail-photo">Photo 2</div>
                <div class="detail-photo">Photo 3</div>
              </div>
              <div class="detail-right">
                <p>상세 정보 내용</p>
              </div>
            </div>
          </div>
        </div>
      </section>
      
      <!-- 최신곡 섹션 -->
      <section id="latest_song">
        <div class="latest-song-wrapper">
          <div class="album-art-container">
            <div class="card card1">앨범아트 1</div>
            <div class="card card2">앨범아트 2</div>
          </div>
          <div class="song-icons" id="song-icons">
            <div class="icon-item">
              <div class="icon">1</div>
              <span>곡 제목 1</span>
            </div>
            <div class="icon-item">
              <div class="icon">2</div>
              <span>곡 제목 2</span>
            </div>
            <div class="icon-item">
              <div class="icon">3</div>
              <span>곡 제목 3</span>
            </div>
            <div class="icon-item">
              <div class="icon">4</div>
              <span>곡 제목 4</span>
            </div>
          </div>
        </div>
      </section>
      
      <!-- VIDEO 섹션 (스크롤 시 카드 등장, 플로팅, 클릭시 중앙 확대) -->
      <section id="video">
        <div class="container">
          <div class="video-container" id="video-container">
            <!-- 6개의 video 카드 -->
            <div class="video-card" data-index="0">Card 1</div>
            <div class="video-card" data-index="1">Card 2</div>
            <div class="video-card" data-index="2">Card 3</div>
            <div class="video-card" data-index="3">Card 4</div>
            <div class="video-card" data-index="4">Card 5</div>
            <div class="video-card" data-index="5">Card 6</div>
            <!-- 닫기 버튼 (숨김) -->
            <button class="close-btn" id="video-close-btn">X</button>
          </div>
        </div>
      </section>
      
      <!-- AWARD 섹션 -->
      <section id="award">
        <div class="container">
          <div class="reward-row" data-direction="ltr">
            <div class="reward-slider">
              <div class="reward-card">Card 1</div>
              <div class="reward-card">Card 2</div>
              <div class="reward-card">Card 3</div>
              <div class="reward-card">Card 4</div>
              <div class="reward-card">Card 5</div>
              <div class="reward-card">Card 6</div>
              <div class="reward-card">Card 1</div>
              <div class="reward-card">Card 2</div>
              <div class="reward-card">Card 3</div>
              <div class="reward-card">Card 4</div>
              <div class="reward-card">Card 5</div>
              <div class="reward-card">Card 6</div>
            </div>
            <div class="fade fade-left"></div>
            <div class="fade fade-right"></div>
          </div>
          <div class="reward-row" data-direction="rtl">
            <div class="reward-slider">
              <div class="reward-card">Card 1</div>
              <div class="reward-card">Card 2</div>
              <div class="reward-card">Card 3</div>
              <div class="reward-card">Card 4</div>
              <div class="reward-card">Card 5</div>
              <div class="reward-card">Card 6</div>
              <div class="reward-card">Card 1</div>
              <div class="reward-card">Card 2</div>
              <div class="reward-card">Card 3</div>
              <div class="reward-card">Card 4</div>
              <div class="reward-card">Card 5</div>
              <div class="reward-card">Card 6</div>
            </div>
            <div class="fade fade-left"></div>
            <div class="fade fade-right"></div>
          </div>
        </div>
      </section>
    </div>
  </div>
  
  <!-- Swiper JS CDN -->
  <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
  <script>
    // 기본 SPA 기능 초기화
    const defaultContent = document.querySelector('.main-content').innerHTML;
    document.addEventListener('DOMContentLoaded', function(){
      const navLinks = document.querySelectorAll('.nav a');
      const mainContent = document.querySelector('.main-content');
      navLinks.forEach(link => {
        link.addEventListener('click', function(e){
          e.preventDefault();
          const page = this.getAttribute('data-page');
          if(page === 'main'){
            mainContent.innerHTML = defaultContent;
            initSwiper();
            initSongIcons();
            initMember();
            initVideo(); // VIDEO 섹션 기능 재초기화
          } else {
            mainContent.innerHTML = `
              <section style="padding: 40px; text-align: center;">
                ${page.toUpperCase()} PAGE CONTENT
              </section>
            `;
          }
        });
      });
      initSwiper();
      initSongIcons();
      initMember();
      initVideo();
    });
    
    function initSwiper(){
      new Swiper('.main_banner', {
        autoplay: { delay: 5000, disableOnInteraction: false },
        loop: true,
        pagination: { el: '.swiper-pagination', clickable: true },
        navigation: {
          nextEl: '.swiper-button-next',
          prevEl: '.swiper-button-prev',
        },
      });
    }
    
    function initSongIcons(){
      const songIcons = document.getElementById('song-icons');
      const spans = songIcons.querySelectorAll('.icon-item span');
      songIcons.addEventListener('mouseenter', function(){
        spans.forEach(span => {
          span.style.display = 'inline-block';
        });
        this.classList.add('vertical');
      });
      songIcons.addEventListener('mouseleave', function(){
        this.classList.remove('vertical');
        spans.forEach(span => {
          span.style.display = 'none';
        });
      });
    }
    
    function initMember(){
      const memberIcons = document.getElementById('member-icons');
      const memberDetail = document.getElementById('member-detail');
      const detailClose = document.getElementById('detail-close');
      memberDetail.style.display = 'none';
      memberIcons.style.display = 'flex';
      memberIcons.querySelectorAll('.member-icon').forEach(icon => {
        icon.addEventListener('click', function(){
          memberIcons.classList.add('fold');
          setTimeout(() => {
            memberIcons.style.display = 'none';
            memberDetail.style.display = 'block';
            setTimeout(() => {
              memberDetail.classList.add('active');
            }, 100);
          }, 1000);
        });
      });
      detailClose.addEventListener('click', function(){
        memberDetail.classList.remove('active');
        setTimeout(() => {
          memberDetail.style.display = 'none';
          memberIcons.style.display = 'flex';
          setTimeout(() => {
            memberIcons.classList.remove('fold');
          }, 200);
        }, 300);
      });
    }
    
    /* VIDEO 섹션 기능 */
    function initVideo(){
      const videoContainer = document.getElementById('video-container');
      const videoCards = Array.from(videoContainer.querySelectorAll('.video-card'));
      const closeBtn = document.getElementById('video-close-btn');
      let activeCard = null;
      const containerRect = videoContainer.getBoundingClientRect();
      const containerWidth = videoContainer.clientWidth;
      
      // 카드 기본 사이즈
      const cardSize = 150; // (모바일 시 CSS에서 조정)
      
      // 3개의 row (총 6개, 한 row당 2개)
      const rowTops = [50, 220, 450]; // video-container 높이 400px 내에서
      // 초기 위치 설정: 각 row에 2개씩 배치, 가로 간격은 카드 width보다 크게 (랜덤)
      function setVideoCardPositions(){
        // 그룹화: row0: 인덱스 0,3 / row1: 인덱스 1,4 / row2: 인덱스 2,5
        const rows = {0:[], 1:[], 2:[]};
        videoCards.forEach((card, idx) => {
          const rowIndex = idx % 3;
          rows[rowIndex].push(card);
        });
        Object.keys(rows).forEach(rowIndex => {
          // 각 row에 2개 있을 것
          const cards = rows[rowIndex];
          // 간단하게: 한 카드의 left를 랜덤하게, 다른 카드는 (랜덤 + 최소 gap) 처리
          const minGap = cardSize; // 최소 gap
          let left1 = Math.random() * (containerWidth - cardSize*2 - minGap) - 20;
          let left2 = left1 + cardSize + minGap + Math.random() * (containerWidth - left1 - cardSize - minGap - cardSize);
          // 무작위 순서로 배치 (좌우 순서 섞기)
          if(Math.random() > 0.5){
            [left1, left2] = [left2, left1];
          }
          cards[0].style.left = left1 + 'px';
          cards[0].style.top = rowTops[rowIndex] + 'px';
          cards[0].style.width = cardSize + 'px';
          cards[0].style.height = cardSize + 'px';
          cards[0].style.lineHeight = cardSize + 'px';
          cards[0].classList.remove('active','hidden');
          cards[0].classList.remove('float-animation');
          cards[0].style.transform = 'translateY(30px)'; // 초기 애니메이션 전
            
          cards[1].style.left = left2 + 'px';
          cards[1].style.top = rowTops[rowIndex] + 'px';
          cards[1].style.width = cardSize + 'px';
          cards[1].style.height = cardSize + 'px';
          cards[1].style.lineHeight = cardSize + 'px';
          cards[1].classList.remove('active','hidden');
          cards[1].classList.remove('float-animation');
          cards[1].style.transform = 'translateY(30px)';
        });
      }
      
      setVideoCardPositions();
      
      // 스크롤 이벤트: video 섹션 1/5 이상 스크롤 시 카드 등장 및 플로팅 애니메이션 적용
      function onScroll(){
        const videoRect = videoContainer.getBoundingClientRect();
        if(videoRect.top < (window.innerHeight - videoContainer.clientHeight/5)){
          videoCards.forEach(card => {
            if(!card.classList.contains('animate')){
              card.classList.add('animate');
              // 트랜지션 후 플로팅 시작
              setTimeout(() => {
                card.classList.add('float-animation');
              }, 500);
            }
          });
          window.removeEventListener('scroll', onScroll);
        }
      }
      window.addEventListener('scroll', onScroll);
      
      // 카드 클릭 이벤트
      videoCards.forEach(card => {
        card.addEventListener('click', function(){
          if(activeCard) return; // 이미 활성화된 카드가 있으면 무시
          activeCard = card;
          // 다른 카드 숨김 처리
          videoCards.forEach(c => { if(c !== card) c.classList.add('hidden'); });
          // 계산: videoContainer 중앙, 확대 크기 80% of container
          const targetWidth = containerWidth * 0.8;
          const targetHeight = videoContainer.clientHeight * 0.8;
          const targetLeft = (containerWidth - targetWidth) / 2;
          const targetTop = (videoContainer.clientHeight - targetHeight) / 2;
          // 제거: 플로팅 애니메이션
          card.classList.remove('float-animation');
          // active 클래스 추가 및 style 변경 (부드러운 전환)
          card.classList.add('active');
          card.style.transition = 'all 0.5s ease';
          card.style.left = targetLeft + 'px';
          card.style.top = targetTop + 'px';
          card.style.width = targetWidth + 'px';
          card.style.height = targetHeight + 'px';
          card.style.lineHeight = targetHeight + 'px';
          // 클릭 후 텍스트 변경 (iframe 대신 "click" 추가)
          setTimeout(() => {
            card.textContent += ' click';
          }, 500);
          // 닫기 버튼 표시
          closeBtn.classList.add('show');
        });
      });
      
      // 닫기 버튼 클릭 이벤트: 활성 카드 원상복구
      closeBtn.addEventListener('click', function(){
        if(!activeCard) return;
        // 원래 카드 상태로 복귀: 랜덤 위치 재설정 및 float 애니메이션 재적용
        activeCard.classList.remove('active');
        activeCard.style.transition = 'all 0.5s ease';
        setVideoCardPositions();
        // 다른 카드 보이기
        videoCards.forEach(c => c.classList.remove('hidden'));
        closeBtn.classList.remove('show');
        activeCard = null;
      });
    }
  </script>
</body>
</html>
